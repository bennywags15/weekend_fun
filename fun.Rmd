---
title: "fun"
author: "Nolan Meyer"
date: "3/25/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
library(tidyverse)
library(dplyr) 
library(readr)
library(ggplot2)
```

```{r}
us_18Q1 <- read_csv("us_18Q1.csv")

eighteen <- us_18Q1 %>% 
  filter(DEM_AGE10 == 1,
         DEM_COLLEGE == 1,
         DEM_STDNT == 1) %>% 
  select( ends_with("NMU"))  #select non-medical use

#opioid non-medical use
eighteen %>% 
  rename(Fentanyl = FENT_NMU,
         Buprenorphine = BUP_NMU,
         Methadone = METH_NMU,
         Morphine = MORPH_NMU,
         Oxycodone = OXY_NMU,
         Oxymorphone = OXYM_NMU,
         Tramadol = TRAM_NMU,
         Tapentadol = TAP_NMU,
         Hydrocodone = HYD_NMU,
         Hydromorphone = HYDM_NMU,
         Sufentanil = SUF_NMU,
         Codeine = COD_NMU,
         Dihydrocodeine = DIHY_NMU) %>% 
  replace(is.na(.), 0) %>% 
  summarise_all(funs(sum)) %>% 
  pivot_longer(cols = Fentanyl:Dihydrocodeine,
               names_to = "drug",
               values_to = "num") %>% 
  ggplot(aes(x = num, y = fct_reorder(drug, num))) +
  geom_col(color = "#21C09C", fill = "#21C09C") +
  labs(title = "Non-medical use of opioids by college students age 18-24 in 2018", x = "", y = "", caption = "Totals out of 1,277 college students age 18-24 surveyed in 2018") +
  theme(plot.title = element_text(size = 14, face = "bold", hjust = 7.55, colour = "Black"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank(),
        plot.background = element_rect(fill = "lightgrey"),
        panel.background = element_rect(fill = "lightgrey"),
        axis.text.x = element_text(size = 9, colour = "Black"),
        axis.text.y = element_text(size = 10, colour = "Black"),
        legend.position = "none"
        )
```
